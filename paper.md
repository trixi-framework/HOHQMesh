---
title: 'HOHQMesh: An All Quadrilateral/Hexahedral Unstructured Mesh Generator for High Order Elements'
tags:
  - Mesh Generation
  - Spectral Element Methods
  - High Order
  - Unstructured Quadrilateral and Hexahedral Meshes
authors:
  - name: David A. Kopriva
    orcid: 0000-0002-8076-0856
    affiliation: "1, 2"
  - name: Andrew R. Winters
    orcid: 0000-0002-5902-1522
    corresponding: true
    affiliation: 3
  - name: Michael Schlottke-Lakemper
    orcid: 0000-0002-3195-2536
    affiliation: 4
  - name: Joseph A. Schoonover
    orcid: 0000-0001-5650-7095
    affiliation: 5
  - name: Hendrik Ranocha
    orcid: 0000-0002-3456-2277
    affiliation: 6
affiliations:
  - name: The Florida State University, Tallahassee, FL, United States of America
    index: 1
  - name: San Diego State University, San Diego, CA, United States of America
    index: 2
  - name: Department of Mathematics; Applied Mathematics, Linköping University, Sweden
    index: 3
  - name: High-Performance Scientific Computing & Centre for Advanced Analytics and Predictive Sciences, University of Augsburg, Germany
    index: 4
  - name: Fluid Numerics, Hickory, NC, United States of America
    index: 5
  - name: Institute of Mathematics, Johannes Gutenberg University Mainz, Germany
    index: 6
date: 01 November 2024
bibliography: paper.bib
---


# Summary

HOHQMesh [@kopriva2024hohqmesh] generates unstructured all-quadrilateral and hexahedral meshes with high order boundary information for use with spectral element solvers. Model input by the user requires only an optional outer boundary curve plus any number of inner boundary curves that are built as chains of simple geometric entities (lines and circles), user defined equations, and cubic splines. Inner boundary curves can be designated as interface boundaries to force element edges along them. Quadrilateral meshes are generated automatically with the mesh sizes guided by a background grid and the model, without additional input by the user. Hexahedral meshes are generated by extrusions of a quadrilateral mesh, including sweeping along a curve, and can follow bottom topography. The mesh files that HOHQMesh generates include high order polynomial interpolation points of arbitrary order.

# Statement of Need

Spectral element methods (SEMs) use multiple degrees of freedom within elements to achieve high order accuracy and can be applied to complex geometries. Details of SEMs can be found in the books by Deville, Fischer and Mund [@Deville:2002fk], Karniadakis and Sherwin [@Karniadakis:2005fj], Hesthaven and Warburton [@Hestahven:1008th], and Kopriva [@Kopriva:2009nx].

Open source spectral element packages now exist to compute solutions of a wide range of equations such as the compressible and incompressible Navier-Stokes, ideal and visco-resistive magnetohydrodynamics, Euler gas dynamics, and shallow water equations, and include Nektar++ [@CANTWELL2015205], SemTex [@BLACKBURN2019106804], Sem2dPack [@ampuero2012spectral], SPECFEM [@Martire:2021xt], Nek5000 [@fischer2008nek5000], HORSES3D [@FERRER2023108700], FLEXI [@KRAIS2021186], FLUXO [@FLUXO], Trixi.jl [@schlottkelakemper2021purely; @ranocha2022adaptive], and NUMA [@Giraldo:2013bh].

The features of SEMs are now well-established. Like low order finite element methods, they can be applied to general geometries, but have exponential convergence in the polynomial approximation order. Discontinuous Galerkin (DGSEM) versions applied to hyperbolic problems have exponentially convergent dissipation and dispersion errors [@ainsworth2004], making them well suited for wave propagation problems. Discontinuous Galerkin SEMs are also especially suitable when material discontinuities are present. Approximations exist for high order quadrilateral/hexahedral and triangle/tetrahedral elements.

What some are now calling “classical” spectral element methods use tensor product bases on quadrilateral or hexahedral meshes. These bases lead to very efficient implementations and have high order quadratures that can be used to approximate the integrals found in weak forms of the equations. Of the widely available spectral element packages, SemTex, Sem2dPack, Nek5000, FLEXI, FLUXO, Trixi.jl, and HORSES3D primarily or exclusively use quadrilateral and hexahedral meshes.

Unfortunately, unstructured meshes for quad/hex elements are difficult to generate even for low order finite elements [@Bommes:2013lc].
The advantages not withstanding, a major impediment to the application of SEMs has been the availability of appropriate general purpose mesh generation software that can generate elements of arbitrary order, especially in open-source form.
In 2002 Sherwin and Peiro [@Sherwin:2002vx] wrote:  "The development of robust unstructured high-order methods is currently limited by the inability to consistently generate valid computational meshes for complex geometries without user intervention." This has remained true particularly for quadrilateral and hexahedral meshes.
For these reasons, HOHQMesh was developed to generate all-quadrilateral and extruded hexahedral meshes suitable for use with spectral element methods. HOHQMesh is a direct quadrilateral mesher, which generates quadrilateral elements by the subdivision method of Schneiders [@schneiders2000algorithms] rather than indirectly from a triangular mesh or by curving a low order mesh. It also adjusts the size and curvature of the elements based on the length scales in the model, rather than attempting to modify an existing low-order mesh.

Examples of meshes generated by HOHQMesh have been published in @winters2014high, @kopriva2016geometry, @acosta2020simulation, @manzanero2020entropy, @ersing2024entropy, @ranocha2024robustness, @PhysRevFluids.9.053901, plus @wintermeyer2018 and @eriksson2024laplacian.

# Features

HOHQMesh is designed to require minimal input from the user through the use of a control file. The model defines the geometry in terms of outer and inner boundary curves.

HOHQMesh features include:

- Unstructured all-quadrilateral or hexahedral meshes
- Isoparametric polynomial boundary approximations of arbitrary order
- Automatic geometry-guided refinement
- Optional user specified local refinement
- Interior boundaries to separate regions of different properties
- Symmetric mesh generation
- Hexahedral meshes from extrusion, rotation, and sweeping of a quadrilateral mesh, with or without scaling
- Bottom topography variations, defined through functional form or input topography data, for extruded hexahedral meshes with automatic resolution of topographic features

HOHQMesh is available as an open-source software package under the MIT license and runs on Linux, macOS, and Windows [@kopriva2024hohqmesh].

# Examples

In 1959 the Malpasset dam in France failed and flooded the Reyran river valley down to the Mediterranean sea [@hervouet1999malpasset],[@goutal1999malpasset]. Fig \ref{fig:Total} shows a mesh of the valley and a portion of the Mediterranean with 2392 fourth order elements generated by HOHQMesh in 0.44s on an Apple MacBook Pro with a 2.3 GHz Quad-Core Intel
i7. A zoom of the western portion of the mesh is shown in Fig. \ref{fig:zoom}. The geometry model consists only of an outer boundary, which was specified as a cubic spline, and no inner boundaries. A control file to generate this mesh can be found in the [Examples/2D/Malpasset](https://github.com/trixi-framework/HOHQMesh/tree/main/Examples/2D/Malpasset) directory.  Fig. \ref{fig:WaterHeight} shows a spectral element computation of the water heights using the mesh of Fig. \ref{fig:Total} in the package TrixiShallowWater.jl [@TrixiSW], which is part of the Trixi.jl [@schlottkelakemper2021purely] ecosystem.

![Spectral element mesh for the Reyran river valley including a portion of the Mediterranean Sea\label{fig:Total}](PaperFigs/malpasset-total-skeleton.png)

![Western portion of the Reyran valley mesh\label{fig:zoom}](PaperFigs/malpasset-total-skeleton-zoom.png)

![Spectral element computation of the water heights at 1985s after the break of the Malpasset dam\label{fig:WaterHeight}](PaperFigs/malpasset_time_1985s.png)

Further examples can be seen in the [gallery](https://trixi-framework.github.io/HOHQMesh/Gallery/). Control files for 29 examples that collectively include all the capabilities of the mesher are available in the [Examples](https://github.com/trixi-framework/HOHQMesh/tree/main/Examples) directory, a table of which is presented in the documentation under [Pre-Made Examples](https://trixi-framework.github.io/HOHQMesh/examples/). Finally, 21 meshes are generated and validated as part of the automated test option.

# Related Software

Special purpose quad/hex spectral element grid generators for simple geometries are openly available as part of some spectral element solvers. The preprocessor for FLEXI, HOPR, for instance, will generate Cartesian boxes and meshes built from combinations of Cartesian boxes, cylinders and spheres.

Spectral element solvers that currently can read meshes generated by HOHQMesh include

- FLUXO [@FLUXO]
- Trixi.jl [@schlottkelakemper2021purely]
- HORSES3D [@FERRER2023108700]

The preprocessor HOPR [@HOPR] can also read and modify quad meshes generated by HOHQMesh.

HOHQMesh can be used with the graphical front end HOHQMesh.jl [@kopriva2024hohqmeshjl].
It is a wrapper package that augments HOHQMesh with interactive functionality
giving a user the ability to create and visualize the meshes without the need to compile from source.

# Acknowledgements

This work was supported by a grant from the Simons Foundation (#426393, #961988, David Kopriva).
Andrew Winters was funded through Vetenskapsrådet, Sweden grant agreement 2020-03642 VR.
Michael Schlottke-Lakemper received funding through the
DFG (Deutsch Forschungsgemeinschaft, German Research Foundation)
research unit FOR-5409 (project number 463312734).
Michael Schlottke-Lakemper and Hendrik Ranocha were supported by a DFG individual grant (project number 528753982).
Hendrik Ranocha was supported by the Daimler und Benz Stiftung (Daimler and Benz foundation, project number 32-10/22).

# References
