---
title: 'HOHQMesh: An all Quadrilateral/Hexahedral Unstructured Mesh Generator for High order Elements'
tags:
  - Mesh Generation
  - Spectral Element Methods
  - High Order
  - Unstructured Quadrilateral and Hexahedral Meshes
authors:
  - name: David A. Kopriva
    orcid: 0000-0002-8076-0856
    affiliation: "1, 2"
  - name: Andrew R. Winters
    orcid: 0000-0002-5902-1522
    corresponding: true
    affiliation: 3
  - name: Michael Schlottke-Lakemper
    orcid: 0000-0002-3195-2536
    affiliation: 4
affiliations:
 - name: Professor Emeritus, The Florida State University, Tallahassee, FL, USA
   index: 1
 - name: Adjunct Professor, San Diego State University, San Diego, CA, USA
   index: 2
 - name: Department of Mathematics; Applied Mathematics, Linköping University, Sweden
   index: 3
 - name: High-Performance Scientific Computing, University of Augsburg, Germany
	index: 4
date: 01 November 2024
bibliography: paper.bib
---


# Summary
HOHQMesh generates unstructured all-quadrilateral and hexahedral meshes with high order boundary information for use with spectral element solvers. Model input by the user requires only an optional outer boundary curve plus any number of inner boundary curves that are built as chains of simple geometric entities (lines and circles), user defined equations, and cubic splines. Inner boundary curves can be designated as interface boundaries to force element edges along them. Quadrilateral meshes are generated automatically with the mesh sizes guided by a background grid and the model, without additional input by the user. Hexahedral meshes are generated by extrusions of a quadrilateral mesh, including sweeping along a curve, and can follow bottom topography. The mesh files that HOHQMesh generates include high order polynomial interpolation points of arbitrary order.

# Statement of Need
Spectral element methods (SEMs) use multiple degrees of freedom within elements to achieve high order accuracy and can be applied to complex geometries. Details of SEMs can be found in the books by Deville, Fischer and Mund [@Deville:2002fk], Karniadakis and Sherwin [@Karniadakis:2005fj], Hesthaven and Warburton [@Hestahven:1008th], and Kopriva [@Kopriva:2009nx].

Open source spectral element packages now exist to compute solutions of a wide range of equations such as the Euler Gas-dynamics, compressible and incompressible Navier-Stokes, magnetohydodynamics, and shallow water equations, and include Nektar++ [@CANTWELL2015205], SemTex [@BLACKBURN2019106804], Sem2dPack [@ampuero2012spectral], SPECFEM [@Martire:2021xt], Nek5000 [@fischer2008nek5000], FLEXI [@KRAIS2021186], FLUXO [@FLUXO], NUMA [@Giraldo:2013bh], Trixi.jl [@schlottkelakemper2021purely], and HORSES3D [@FERRER2023108700].

The features of SEMs are now well-established. Like low order finite element methods, they can be applied to general geometries, but have exponential convergence in the polynomial approximation order. Discontinuous Galerkin (DGSEM) versions applied to hyperbolic problems have exponentially convergent dissipation and dispersion errors [@ainsworth2004], making them well suited for wave propagation problems. Discontinuous Galerkin SEMs are also especially suitable when material discontinuities are present. Approximations exist for high order quadrilateral/hexahedral and triangle/tetrahedral elements.

What some are now calling “classical” spectral element methods use tensor product bases on quadrilateral or hexahedral meshes. These bases lead to very efficient implementations and have high order quadratures that can be used to approximate the integrals found in weak forms of the equations. Of the widely available spectral element packages, SemTex, Sem2dPack, Nek5000, FLEXI, FLUXO, Trixi.jl, and HORSES3D primarily or exclusively use quadrilateral and hexahedral meshes.

Unfortunately, unstructured meshes for quad/hex elements are difficult to generate even for low order finite elements [@Bommes:2013lc].
The advantages not withstanding, a major impediment to the application of SEMs has been the availability of appropriate general purpose mesh generation software that can generate elements of arbitrary order, especially in open-source form. A survey of the literature, practitioners, and user manuals for available spectral element software packages highlights these difficulties. In 2002 Sherwin and Peiro [@Sherwin:2002vx] wrote:  "The development of robust unstructured high-order methods is currently limited by the inability to consistently generate valid computational meshes for complex geometries without user intervention." This has remained true particularly for quadrilateral and hexahedral meshes.

For these reasons, HOHQMesh was developed to generate all-quadrilateral and extruded hexahedral meshes suitable for use with spectral element methods. HOHQMesh is a direct quadrilateral mesher, which generates quadrilateral elements by the subdivision method of Schneiders [@schneiders2000algorithms] rather than indirectly from a triangular mesh or by curving a low order mesh. It also sizes and curves the elements based on the length scales in the model, rather than try to modify an existing low order mesh.

#Features
HOHQMesh is designed to require minimal input from the user through the use of a control file. The model defines the geometry in terms of an outer and inner boundary curves.

HOHQMesh features include:

- Unstructured all-quadrilateral or hexahedral meshes
- Isoparametric polynomial boundary approximations of arbitrary order
- Automatic geometry-guided refinement
- Optional user specified local refinement
- Interior boundaries to separate regions of different properties
- Symmetric mesh generation
- Hexahedral meshes from extrusion, rotation, and sweeping of a quadrilateral mesh, with or without scaling
- Bottom topography variations for extruded hexahedral meshes with automatic resolution of topographic features

#Example
In 1959 the Malpasset dam in France failed and flooded the Reyran river valley down to the Mediterranean sea [@hervouet1999malpasset],[@goutal1999malpasset]. Fig \ref{fig:Total} shows a mesh with 2392 fourth order elements generated by HOHQMesh in 0.44s on an Apple MacBook Pro with a 2.3 GHz Quad-Core Intel
i7. A zoom of the western portion of the mesh is shown in Fig. \ref{fig:zoom}. The geometry model consists only of an outer boundary, which was specified as a cubic spline, and no inner boundaries. Fig. \ref{fig:WaterHeight} shows a spectral element computation of the water heights using the mesh of Fig. \ref{fig:Total} in the package Trixi.jl [@schlottkelakemper2021purely].

![Spectral element mesh for the Reyran river valley including a portion of the Mediterranean Sea\label{fig:Total)](PaperFigs/malpasset-total-skeleton.png)

![Western portion of the Reyran valley mesh\label{fig:zoom}](PaperFigs/malpasset-total-skeleton-zoom.png)

![Spectral element conputation of the water heights at 1985s after the break of the Malpasset dam\label{fig:WaterHeight}](PaperFigs/malpasset_time_1985s.png)

#Related Software
Special purpose quad/hex spectral element grid generators for simple geometries are openly available as part of some spectral element solvers. The preprocessor for FLEXI, HOPR, for instance, will generate cartesian boxes and meshes built from combinations of cartesian boxes, cylinders and spheres.

Spectral element solvers that currently can read meshes generated by HOHQMesh include

- FLUXO [@FLUXO]
- Trixi.jl [@schlottkelakemper2021purely]
- HORSES3D [@FERRER2023108700]

The preprocessor HOPR [@HOPR] can also read and modify these meshes.

HOHQMesh can be used with the graphical front end HOHQMesh.jl [@HOHQMESHJL:2022sb].

#Acknowledgements
 This work was supported by a grant from the Simons Foundation (#426393, #961988, David Kopriva).
# References
