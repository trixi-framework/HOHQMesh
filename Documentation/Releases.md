# Creating a new HOHQMesh release

This document describes the necessary steps for creating a new HOHQMesh release.
When following these guidelines, don't forget to replace `1.2.3` with the
current release version of HOHQMesh, and `1.3.0` with the new release you are
about to create.

*Note: All steps as described here are assumed to be performed in a
clean clone of the `master` branch.*

## Pre-release preparations
1. Ensure that the current HOHQMesh commit on `master` has passed all tests on
   GitHub by verifying that there is a green checkmark behind the latest commit
   on https://github.com/trixi-framework/HOHQMesh/commits/master.
2. Enter the HOHQMesh clone directory, switch to `master`, and pull the latest version from GitHub:
   ```bash
   cd HOHQMesh
   git checkout master
   git pull
   ```
3. Get the latest version tag by executing
   ```bash
   git tag --list 'v*' --sort -version:refname | head -n1
   ```
   This will yield something like `v1.2.3`, where `1.2.3` is the version number
   and the `v` prefix is to indicate that this is really a version tag.
4. Compare this with the
   [latest release](https://github.com/trixi-framework/HOHQMesh/releases/latest)
   on GitHub. If the version numbers of the latest tag and the latest release
   differ, investigate (and possibly fix it) before proceeding.
5. Determine which kind of version increment is necessary based on the changes
   since the last release. We use [semantic versioning](https://semver.org),
   which [states](https://semver.org/spec/v2.0.0.html#summary)
   > Given a version number MAJOR.MINOR.PATCH, increment the:
   >
   > MAJOR version when you make incompatible API changes,  
   > MINOR version when you add functionality in a backwards compatible manner, and  
   > PATCH version when you make backwards compatible bug fixes.

   To see all the changes since the last release, you can use GitHub's `compare`
   functionality by navigating to the following address, adjusting the version
   tag appropriately:  
   https://github.com/trixi-framework/HOHQMesh/compare/v1.2.3...master

   Let's say that the changes require a *minor* version increment, thus the new
   release version following `1.2.3` would be `1.3.0`.

## Release creation
1. Increment the version number in [Source/HOHQMeshMain.f90](../Source/HOHQMeshMain.f90).
   The current version in the file should be something like `1.2.4-pre`,
   indicating that the `master` branch is in a pre-release state (as it should be
   during development). Change the pre-release version string to the new version
   number you determined above, e.g., to `1.3.0`:
   ```fortran
   CHARACTER(LEN=*), PARAMETER :: version           = "1.3.0"
   ```
2. Commit and push to `master`:
   ```bash
   git add Source/HOHQMeshMain.f90
   git commit -m 'Increment version to v1.3.0'
   git push
   ```
3. Create a new release tarball by executing
   ```bash
   ./Utilities/createrelease 1.3.0
   ```
   where `1.3.0` again refers to the new release version. This will not just
   create a release tarball but also verify that alIf
   there are no errors, this will result in a new file `HOHQMesh-v1.3.0.tar.gz`
   in the current directory.
3. Create a new annotated Git tag for the current 
3. Navigate to https://github.com/trixi-framework/HOHQMesh/releases/new to start
   creating a new release.
4. Enter `v1.3.0` as the `Tag version`, which will create a Git tag of this
   name.
5. Use `HOHQMesh v1.3.0` as the `Release title`.
6. Feel free to add more information about this release in the description field
   (optional).
7. Click `Publish release`.


## Post-release actions
2. Attach the file you just created to the new release by navigating to the 
   [latest release](https://github.com/trixi-framework/HOHQMesh/releases/latest)
   and clicking `Edit release`. You can then drag and drop the tarball in the
   gray area below the release description. Click `Update release`.
3. Increment the version number in
   [Source/HOHQMeshMain.f90](../Source/HOHQMeshMain.f90) to a pre-release
   version to indicate that the content of the `master` branch does not
   necessarily reflect the files of an existing, tagged release. The pre-release
   version is generated by incrementing the patch version and appending `-pre`.
   For example, if you just created the release `1.3.0`, the next pre-release
   version would be `1.3.1-pre`.
4. Commit and push to `master`.
